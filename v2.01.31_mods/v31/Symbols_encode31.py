#!/usr/bin/env python3

from sys import argv,exit
import struct

if len(argv)!=3: print('Usage: Symbols_encode.py <image.bmp> <output_python_patch.py>') ; exit(1)

def bit_not(n, numbits=8):
    return bytes([(1 << numbits) - 1 - n,])

image = b''
image = open(argv[1],'rb').read()
im = image[0x3E:len(image)]

if len(im)!=1768:
    print('Different image format, must be 8x442 1bit vertical. Inputting GENUINE symbols!')
    im = b'\x31\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x46\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x10\x00\x00\x00\x08\x00\x00\x00\x04\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\xFF\x00\x00\x00\x81\x00\x00\x00\x85\x00\x00\x00\x95\x00\x00\x00\x95\x00\x00\x00\x95\x00\x00\x00\x95\x00\x00\x00\xBD\x00\x00\x00\x81\x00\x00\x00\xFF\x00\x00\x00\x7F\x00\x00\x00\x02\x00\x00\x00\x0C\x00\x00\x00\x02\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x18\x00\x00\x00\xFF\x00\x00\x00\x42\x00\x00\x00\x42\x00\x00\x00\x24\x00\x00\x00\x24\x00\x00\x00\x18\x00\x00\x00\x18\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x20\x00\x00\x00\x18\x00\x00\x00\x20\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x3E\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x14\x00\x00\x00\x08\x00\x00\x00\x14\x00\x00\x00\x63\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x20\x00\x00\x00\x18\x00\x00\x00\x20\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x14\x00\x00\x00\x08\x00\x00\x00\x14\x00\x00\x00\x63\x00\x00\x00\x00\x00\x00\x00\x3E\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x1F\x00\x00\x00\x20\x00\x00\x00\x40\x00\x00\x00\x20\x00\x00\x00\x1F\x00\x00\x00\x00\x00\x00\x00\x7C\x00\x00\x00\x46\x00\x00\x00\x45\x00\x00\x00\x45\x00\x00\x00\x45\x00\x00\x00\x45\x00\x00\x00\x46\x00\x00\x00\x7C\x00\x00\x00\x00\x00\x00\x00\x1C\x00\x00\x00\x27\x00\x00\x00\x44\x00\x00\x00\x44\x00\x00\x00\x44\x00\x00\x00\x44\x00\x00\x00\x27\x00\x00\x00\x1C\x00\x00\x00\x00\x00\x00\x00\x46\x00\x00\x00\x29\x00\x00\x00\x19\x00\x00\x00\x09\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x22\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x32\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x26\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x02\x00\x00\x00\x0C\x00\x00\x00\x02\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x7F\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x3E\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x22\x00\x00\x00\x14\x00\x00\x00\x08\x00\x00\x00\x14\x00\x00\x00\x22\x00\x00\x00\x63\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x7F\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x22\x00\x00\x00\x14\x00\x00\x00\x08\x00\x00\x00\x14\x00\x00\x00\x22\x00\x00\x00\x63\x00\x00\x00\x00\x00\x00\x00\x46\x00\x00\x00\x29\x00\x00\x00\x19\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x32\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x26\x00\x00\x00\x00\x00\x00\x00\x22\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x3E\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x7F\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x22\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x02\x00\x00\x00\x0C\x00\x00\x00\x02\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x7C\x00\x00\x00\x12\x00\x00\x00\x11\x00\x00\x00\x12\x00\x00\x00\x7C\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x7F\x00\x00\x00\x22\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x7F\x00\x00\x00\x22\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x7F\x00\x00\x00\x22\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x5D\x00\x00\x00\x5D\x00\x00\x00\x41\x00\x00\x00\x7F\x00\x00\x00\x22\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x63\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x7F\x00\x00\x00\x22\x00\x00\x00\x3E\x00\x00\x00\x00\x00\x00\x00\x18\x00\x00\x00\x18\x00\x00\x00\x3C\x00\x00\x00\x3C\x00\x00\x00\x7E\x00\x00\x00\x7E\x00\x00\x00\xFF\x00\x00\x00\xFF\x00\x00\x00\x01\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x32\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x49\x00\x00\x00\x26\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x20\x00\x00\x00\x10\x00\x00\x00\x08\x00\x00\x00\x04\x00\x00\x00\x02\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x0C\x00\x00\x00\x0C\x00\x00\x00\x0C\x00\x00\x00\x0C\x00\x00\x00\x0C\x00\x00\x00\x0C\x00\x00\x00\x0C\x00\x00\x00\x00\x00\x00\x00\x18\x00\x00\x00\x18\x00\x00\x00\x7E\x00\x00\x00\x7E\x00\x00\x00\x7E\x00\x00\x00\x18\x00\x00\x00\x18\x00\x00\x00\x00\x00\x00\x00\x46\x00\x00\x00\x29\x00\x00\x00\x19\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x09\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x00\x40\x00\x00\x00\x40\x00\x00\x00\x40\x00\x00\x00\x40\x00\x00\x00\x40\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x02\x00\x00\x00\x04\x00\x00\x00\x18\x00\x00\x00\x04\x00\x00\x00\x02\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x14\x00\x00\x00\x14\x00\x00\x00\x22\x00\x00\x00\x22\x00\x00\x00\x41\x00\x00\x00\x41\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x1C\x00\x00\x00\x1C\x00\x00\x00\x3E\x00\x00\x00\x3E\x00\x00\x00\x7F\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x02\x00\x00\x00\x04\x00\x00\x00\x18\x00\x00\x00\x04\x00\x00\x00\x02\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x1C\x00\x00\x00\x3E\x00\x00\x00\x3E\x00\x00\x00\x1C\x00\x00\x00\x08\x00\x00\x00\x03\x00\x00\x00\x05\x00\x00\x00\x7F\x00\x00\x00\x05\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x7F\x00\x00\x00\x7F\x00\x00\x00\x00\x00\x00\x00\x7E\x00\x00\x00\x7E\x00\x00\x00\x00\x00\x00\x00\x7C\x00\x00\x00\x7C\x00\x00\x00\x00\x00\x00\x00\x78\x00\x00\x00\x78\x00\x00\x00\x00\x00\x00\x00\x70\x00\x00\x00\x70\x00\x00\x00\x00\x00\x00\x00\x60\x00\x00\x00\x60\x00\x00\x00'
else:
    print('Image data looks OK. Inserting modded bitmaps.')

# change to 1bit encoding
raw = b''
for i in range(len(im)//4):
    raw += bit_not((im[4*i:1+4*i])[0],8)

raw = bytes(reversed(raw))
symbols_patch = ''.join([f'\\x{i:02X}' for i in raw])

with open(argv[2],'w') as f, open('v31\Symbols_encode31.template','r') as template:
    f.write(template.read().replace('{_ARRAY_}',symbols_patch))
